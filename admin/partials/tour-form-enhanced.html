<!-- admin/partials/tour-form-enhanced.html -->
<div id="tourFormModal" class="modal-overlay hidden">
    <div class="modal-content max-w-6xl">
        <div class="modal-header">
            <h3 id="tourFormTitle" class="text-xl font-bold text-white">Yeni Tur Ekle</h3>
            <button onclick="closeTourForm()" class="text-white hover:text-gray-300">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>

        <form id="tourForm" class="modal-body max-h-[80vh] overflow-y-auto">
            <!-- Temel Bilgiler -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-info-circle text-blue-500 mr-2"></i>
                    Temel Bilgiler
                </h4>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Tur Başlığı <span class="text-red-500">*</span>
                        </label>
                        <input type="text" name="title" id="tourTitle" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="Örn: Ekonomik Umre Turu 2025">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Kategori <span class="text-red-500">*</span>
                        </label>
                        <select name="category_id" id="tourCategory" required
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="">Kategori Seçin</option>
                        </select>
                    </div>
                </div>

                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Kısa Açıklama
                    </label>
                    <textarea name="short_description" id="tourShortDescription" rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                              placeholder="Tur hakkında kısa açıklama (card'larda görünecek)"></textarea>
                </div>

                <div class="mt-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Detaylı Açıklama
                    </label>
                    <textarea name="description" id="tourDescription" rows="4"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                              placeholder="Tur hakkında detaylı açıklama"></textarea>
                </div>
            </div>

            <!-- Tarih ve Süre Bilgileri -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-calendar-alt text-green-500 mr-2"></i>
                    Tarih ve Süre Bilgileri
                </h4>
                
                <div class="grid md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Başlangıç Tarihi
                        </label>
                        <input type="date" name="start_date" id="tourStartDate"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Bitiş Tarihi
                        </label>
                        <input type="date" name="end_date" id="tourEndDate"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Toplam Gün
                        </label>
                        <input type="number" name="duration_days" id="tourDurationDays" min="1"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="7">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Toplam Gece
                        </label>
                        <input type="number" name="duration_nights" id="tourDurationNights" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="6">
                    </div>
                </div>

                <div class="grid md:grid-cols-2 gap-4 mt-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Mekke'de Gece Sayısı
                        </label>
                        <input type="number" name="mekke_nights" id="tourMekkeNights" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="4">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Medine'de Gece Sayısı
                        </label>
                        <input type="number" name="medine_nights" id="tourMedineNights" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="2">
                    </div>
                </div>
            </div>

            <!-- Fiyat ve Kota -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-money-bill-wave text-yellow-500 mr-2"></i>
                    Fiyat ve Kota Bilgileri
                </h4>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Fiyat (TL) <span class="text-red-500">*</span>
                        </label>
                        <input type="number" name="price_try" id="tourPriceTry" required min="0" step="0.01"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="15000.00">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Kota (Kişi Sayısı)
                        </label>
                        <input type="number" name="quota" id="tourQuota" min="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="40">
                    </div>
                </div>
            </div>

            <!-- Resim Yükleme -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-image text-purple-500 mr-2"></i>
                    Tur Görseli
                </h4>
                
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        Ana Tur Resmi
                    </label>
                    <div class="mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md">
                        <div class="space-y-1 text-center">
                            <div id="imagePreview" class="hidden mb-4">
                                <img id="previewImage" src="" alt="Preview" class="mx-auto h-32 w-auto rounded">
                            </div>
                            <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48">
                                <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <div class="flex text-sm text-gray-600">
                                <label for="tourImageUpload" class="relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-blue-500">
                                    <span>Resim Yükle</span>
                                    <input id="tourImageUpload" name="image" type="file" accept="image/*" class="sr-only">
                                </label>
                                <p class="pl-1">veya sürükle bırak</p>
                            </div>
                            <p class="text-xs text-gray-500">PNG, JPG, WEBP formatları (Max: 5MB)</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Otel Bilgileri -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-hotel text-blue-500 mr-2"></i>
                    Otel Bilgileri
                </h4>
                
                <div class="space-y-6">
                    <!-- Mekke Oteli -->
                    <div>
                        <h5 class="text-md font-semibold text-gray-700 mb-3 flex items-center">
                            <i class="fas fa-mosque text-green-600 mr-2"></i>
                            Mekke Oteli
                        </h5>
                        
                        <textarea name="mekke_hotel" id="tourMekkeHotel" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Otel adı, yıldız sayısı, Harem'e mesafe, özellikler..."></textarea>
                        
                        <!-- Mekke Otel Resimleri -->
                        <div class="mt-3">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Mekke Otel Resimleri
                            </label>
                            <input type="file" name="mekke_hotel_images" id="mekkeHotelImages" multiple accept="image/*"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <div id="mekkeHotelPreview" class="mt-2 grid grid-cols-3 gap-2"></div>
                        </div>
                    </div>

                    <!-- Medine Oteli -->
                    <div>
                        <h5 class="text-md font-semibold text-gray-700 mb-3 flex items-center">
                            <i class="fas fa-mosque text-blue-600 mr-2"></i>
                            Medine Oteli
                        </h5>
                        
                        <textarea name="medine_hotel" id="tourMedineHotel" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Otel adı, yıldız sayısı, Mescid-i Nebevi'ye mesafe, özellikler..."></textarea>
                        
                        <!-- Medine Otel Resimleri -->
                        <div class="mt-3">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                Medine Otel Resimleri
                            </label>
                            <input type="file" name="medine_hotel_images" id="medineHotelImages" multiple accept="image/*"
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <div id="medineHotelPreview" class="mt-2 grid grid-cols-3 gap-2"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hizmetler -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-concierge-bell text-green-500 mr-2"></i>
                    Hizmet Detayları
                </h4>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-check text-green-500 mr-1"></i>
                            Dahil Hizmetler
                        </label>
                        <textarea name="included_services" id="tourIncludedServices" rows="6"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Her satıra bir hizmet yazın:
Uçak bileti (gidiş-dönüş)
Vize işlemleri
Otel konaklaması
Rehberlik hizmeti
Transfer hizmetleri"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-times text-red-500 mr-1"></i>
                            Dahil Olmayan Hizmetler
                        </label>
                        <textarea name="excluded_services" id="tourExcludedServices" rows="6"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Her satıra bir hizmet yazın:
Ekstra yemekler
Kişisel harcamalar
İsteğe bağlı turlar
Bahşişler"></textarea>
                    </div>
                </div>
            </div>

            <!-- Ziyaret Yerleri -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-map-marker-alt text-red-500 mr-2"></i>
                    Ziyaret Edilecek Yerler
                </h4>
                
                <textarea name="visit_places" id="tourVisitPlaces" rows="6"
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                          placeholder="Her satıra bir yer yazın:
Kabe-i Şerif (Tavaf)
Safa ve Merve Tepeleri (Sa'y)
Mescid-i Nebevi
Ravza-i Mutahhara
Uhud Dağı
Kuba Camii"></textarea>
            </div>

            <!-- Uçuş Bilgileri -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-plane text-blue-500 mr-2"></i>
                    Uçuş Bilgileri
                </h4>
                
                <div class="grid md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Gidiş Uçuş Bilgileri
                        </label>
                        <textarea name="departure_info" id="tourDepartureInfo" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Havayolu, uçuş saatleri, aktarma bilgileri..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Dönüş Uçuş Bilgileri
                        </label>
                        <textarea name="return_info" id="tourReturnInfo" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Havayolu, uçuş saatleri, aktarma bilgileri..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Günlük Program -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-calendar-day text-purple-500 mr-2"></i>
                    Günlük Program
                </h4>
                
                <div id="dailyScheduleContainer">
                    <div class="text-center py-4">
                        <button type="button" onclick="addDayToSchedule()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                            <i class="fas fa-plus mr-2"></i>Gün Ekle
                        </button>
                    </div>
                </div>

                <input type="hidden" name="daily_schedule" id="dailyScheduleData">
            </div>

            <!-- Belgeler ve Notlar -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-file-alt text-gray-500 mr-2"></i>
                    Belgeler ve Ek Bilgiler
                </h4>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Gerekli Belgeler
                        </label>
                        <textarea name="required_documents" id="tourRequiredDocuments" rows="4"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Her satıra bir belge yazın:
Pasaport (en az 6 ay geçerli)
2 adet biyometrik fotoğraf
Nüfus cüzdanı sureti
Sağlık raporu"></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Önemli Notlar
                        </label>
                        <textarea name="important_notes" id="tourImportantNotes" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Tur ile ilgili önemli notlar..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            İptal Politikası
                        </label>
                        <textarea name="cancellation_policy" id="tourCancellationPolicy" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="İptal koşulları ve ücretleri..."></textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Ödeme Şartları
                        </label>
                        <textarea name="payment_terms" id="tourPaymentTerms" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="Ödeme planı ve koşulları..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Durum ve Ayarlar -->
            <div class="bg-white rounded-lg p-6 mb-6 shadow-sm">
                <h4 class="text-lg font-semibold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-cog text-gray-500 mr-2"></i>
                    Durum ve Ayarlar
                </h4>
                
                <div class="grid md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Durum
                        </label>
                        <select name="status" id="tourStatus"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="active">Aktif</option>
                            <option value="inactive">Pasif</option>
                            <option value="draft">Taslak</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Öncelik Sırası
                        </label>
                        <input type="number" name="priority" id="tourPriority" min="0" value="0"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                               placeholder="0">
                    </div>
                    
                    <div class="flex items-center pt-6">
                        <label class="flex items-center">
                            <input type="checkbox" name="featured" id="tourFeatured" class="mr-2">
                            <span class="text-sm font-medium text-gray-700">
                                <i class="fas fa-star text-yellow-500 mr-1"></i>
                                Öne Çıkan Tur
                            </span>
                        </label>
                    </div>
                </div>
            </div>
        </form>

        <!-- Modal Footer -->
        <div class="modal-footer">
            <button type="button" onclick="closeTourForm()" class="btn-secondary">
                <i class="fas fa-times mr-2"></i>İptal
            </button>
            <button type="submit" form="tourForm" class="btn-primary">
                <i class="fas fa-save mr-2"></i>
                <span id="tourSubmitText">Kaydet</span>
            </button>
        </div>
    </div>
</div>

<style>
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    padding: 20px;
}

.modal-content {
    background: white;
    border-radius: 12px;
    width: 100%;
    max-height: 95vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.modal-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 20px;
    display: flex;
    justify-content: between;
    align-items: center;
}

.modal-body {
    padding: 20px;
    overflow-y: auto;
}

.modal-footer {
    padding: 20px;
    border-top: 1px solid #e5e7eb;
    display: flex;
    justify-content: flex-end;
    gap: 12px;
    background: #f9fafb;
}

.btn-primary {
    background: linear-gradient(135deg, #3B82F6, #1D4ED8);
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
}

.btn-secondary {
    background: #6b7280;
    color: white;
    padding: 10px 20px;
    border-radius: 8px;
    border: none;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-secondary:hover {
    background: #4b5563;
}

.day-schedule-item {
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 16px;
    margin-bottom: 16px;
    background: #f9fafb;
}

.day-schedule-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.remove-day-btn {
    background: #ef4444;
    color: white;
    border: none;
    border-radius: 50%;
    width: 32px;
    height: 32px;
    cursor: pointer;
    transition: all 0.2s;
}

.remove-day-btn:hover {
    background: #dc2626;
    transform: scale(1.1);
}
</style>

<script>
let dailySchedule = [];

// Gün ekleme fonksiyonu
function addDayToSchedule() {
    const dayNumber = dailySchedule.length + 1;
    const dayData = {
        day: dayNumber,
        title: `${dayNumber}. Gün`,
        description: '',
        activities: []
    };
    
    dailySchedule.push(dayData);
    renderDailySchedule();
    updateDailyScheduleInput();
}

// Gün silme fonksiyonu
function removeDayFromSchedule(index) {
    dailySchedule.splice(index, 1);
    // Gün numaralarını yeniden düzenle
    dailySchedule.forEach((day, i) => {
        day.day = i + 1;
        day.title = `${i + 1}. Gün`;
    });
    renderDailySchedule();
    updateDailyScheduleInput();
}

// Günlük programı render et
function renderDailySchedule() {
    const container = document.getElementById('dailyScheduleContainer');
    
    let html = '';
    
    dailySchedule.forEach((day, index) => {
        html += `
            <div class="day-schedule-item">
                <div class="day-schedule-header">
                    <h5 class="font-semibold text-gray-800">
                        <i class="fas fa-calendar-day text-blue-500 mr-2"></i>
                        ${day.title}
                    </h5>
                    <button type="button" onclick="removeDayFromSchedule(${index})" class="remove-day-btn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="space-y-3">
                    <input type="text" 
                           placeholder="Gün başlığı (örn: İstanbul - Cidde)"
                           value="${day.title}"
                           onchange="updateDayTitle(${index}, this.value)"
                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                    
                    <textarea placeholder="Gün açıklaması..."
                              onchange="updateDayDescription(${index}, this.value)"
                              rows="2"
                              class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">${day.description}</textarea>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            Aktiviteler (isteğe bağlı)
                        </label>
                        <div id="activities-${index}">
                            ${day.activities.map((activity, actIndex) => `
                                <div class="flex gap-2 mb-2">
                                    <input type="text" placeholder="Saat" value="${activity.time}"
                                           onchange="updateActivity(${index}, ${actIndex}, 'time', this.value)"
                                           class="w-20 px-2 py-1 border border-gray-300 rounded text-sm">
                                    <input type="text" placeholder="Aktivite" value="${activity.activity}"
                                           onchange="updateActivity(${index}, ${actIndex}, 'activity', this.value)"
                                           class="flex-1 px-2 py-1 border border-gray-300 rounded text-sm">
                                    <button type="button" onclick="removeActivity(${index}, ${actIndex})"
                                            class="px-2 py-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        <button type="button" onclick="addActivity(${index})"
                                class="mt-2 px-3 py-1 bg-green-500 text-white rounded text-sm hover:bg-green-600">
                            <i class="fas fa-plus mr-1"></i>Aktivite Ekle
                        </button>
                    </div>
                </div>
            </div>
        `;
    });
    
    html += `
        <div class="text-center py-4">
            <button type="button" onclick="addDayToSchedule()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600">
                <i class="fas fa-plus mr-2"></i>Gün Ekle
            </button>
        </div>
    `;
    
    container.innerHTML = html;
}

// Gün başlığını güncelle
function updateDayTitle(dayIndex, title) {
    dailySchedule[dayIndex].title = title;
    updateDailyScheduleInput();
}

// Gün açıklamasını güncelle
function updateDayDescription(dayIndex, description) {
    dailySchedule[dayIndex].description = description;
    updateDailyScheduleInput();
}

// Aktivite ekle
function addActivity(dayIndex) {
    dailySchedule[dayIndex].activities.push({
        time: '',
        activity: ''
    });
    renderDailySchedule();
    updateDailyScheduleInput();
}

// Aktivite sil
function removeActivity(dayIndex, activityIndex) {
    dailySchedule[dayIndex].activities.splice(activityIndex, 1);
    renderDailySchedule();
    updateDailyScheduleInput();
}

// Aktivite güncelle
function updateActivity(dayIndex, activityIndex, field, value) {
    dailySchedule[dayIndex].activities[activityIndex][field] = value;
    updateDailyScheduleInput();
}

// Günlük program input'unu güncelle
function updateDailyScheduleInput() {
    document.getElementById('dailyScheduleData').value = JSON.stringify(dailySchedule);
}

// Resim önizleme
document.getElementById('tourImageUpload').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('previewImage').src = e.target.result;
            document.getElementById('imagePreview').classList.remove('hidden');
        };
        reader.readAsDataURL(file);
    }
});

// Otel resimleri önizleme
function setupHotelImagePreview(inputId, previewId) {
    document.getElementById(inputId).addEventListener('change', function(e) {
        const files = Array.from(e.target.files);
        const previewContainer = document.getElementById(previewId);
        previewContainer.innerHTML = '';
        
        files.forEach((file, index) => {
            if (file.type.startsWith('image/')) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const imageDiv = document.createElement('div');
                    imageDiv.className = 'relative';
                    imageDiv.innerHTML = `
                        <img src="${e.target.result}" class="w-full h-20 object-cover rounded">
                        <span class="text-xs text-gray-500">${file.name}</span>
                    `;
                    previewContainer.appendChild(imageDiv);
                };
                reader.readAsDataURL(file);
            }
        });
    });
}

// Otel resim önizlemelerini kurur
document.addEventListener('DOMContentLoaded', function() {
    setupHotelImagePreview('mekkeHotelImages', 'mekkeHotelPreview');
    setupHotelImagePreview('medineHotelImages', 'medineHotelPreview');
});

// Form kapatma
function closeTourForm() {
    document.getElementById('tourFormModal').classList.add('hidden');
    // Formu sıfırla
    document.getElementById('tourForm').reset();
    dailySchedule = [];
    renderDailySchedule();
    document.getElementById('imagePreview').classList.add('hidden');
    document.getElementById('mekkeHotelPreview').innerHTML = '';
    document.getElementById('medineHotelPreview').innerHTML = '';
}
</script>