<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tur Detayı - Nahletur.com</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        .line-clamp-2 { 
            display: -webkit-box; 
            -webkit-line-clamp: 2; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }
        .line-clamp-3 { 
            display: -webkit-box; 
            -webkit-line-clamp: 3; 
            -webkit-box-orient: vertical; 
            overflow: hidden; 
        }
        .sticky-booking {
            position: sticky;
            top: 100px;
            z-index: 10;
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { 
            border-bottom-color: #3B82F6; 
            color: #3B82F6; 
        }
        .hero-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }
        .timeline-item:before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            height: 100%;
            width: 2px;
            background: #e5e7eb;
        }
        .timeline-item:last-child:before {
            display: none;
        }
        .day-number {
            background: linear-gradient(135deg, #3B82F6, #1D4ED8);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            z-index: 2;
        }
        .hotel-card {
            transition: all 0.3s ease;
        }
        .hotel-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .floating-contact {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .gradient-overlay {
            background: linear-gradient(45deg, rgba(59, 130, 246, 0.9), rgba(147, 51, 234, 0.9));
        }
        .pricing-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            border: 2px solid #e2e8f0;
        }
        .pricing-card.featured {
            background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%);
            color: white;
            border-color: #3B82F6;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Loading State -->
    <div id="loadingState" class="flex items-center justify-center min-h-screen">
        <div class="text-center">
            <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-blue-500 mx-auto mb-4"></div>
            <p class="text-gray-600 text-lg">Tur detayları yükleniyor...</p>
        </div>
    </div>

    <!-- Error State -->
    <div id="errorState" class="hidden min-h-screen flex items-center justify-center">
        <div class="text-center">
            <div class="text-red-500 mb-6">
                <i class="fas fa-exclamation-triangle text-6xl"></i>
            </div>
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Tur Bulunamadı</h2>
            <p class="text-gray-600 mb-8">Aradığınız tur mevcut değil veya kaldırılmış olabilir.</p>
            <a href="/" class="bg-blue-500 text-white px-8 py-3 rounded-lg hover:bg-blue-600 transition-colors font-medium">
                <i class="fas fa-home mr-2"></i>Ana Sayfaya Dön
            </a>
        </div>
    </div>

    <!-- Tour Detail Content -->
    <div id="tourContent" class="hidden">
        <!-- Header Navigation -->
        <nav class="bg-white shadow-sm border-b sticky top-0 z-50">
            <div class="container mx-auto px-4">
                <div class="flex items-center justify-between h-16">
                    <a href="/" class="flex items-center space-x-2">
                        <img src="/assets/logo.png" alt="Nahletur" class="h-8">
                        <span class="font-bold text-xl text-gray-800">Nahletur</span>
                    </a>
                    
                    <div class="flex items-center space-x-4">
                        <button id="shareButton" class="flex items-center space-x-2 text-gray-600 hover:text-blue-600 transition-colors">
                            <i class="fas fa-share-alt"></i>
                            <span class="hidden md:block">Paylaş</span>
                        </button>
                        <button id="favoriteButton" class="flex items-center space-x-2 text-gray-600 hover:text-red-600 transition-colors">
                            <i class="far fa-heart"></i>
                            <span class="hidden md:block">Favorile</span>
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Breadcrumb -->
        <div class="bg-gray-100 py-3">
            <div class="container mx-auto px-4">
                <nav class="flex items-center space-x-2 text-sm">
                    <a href="/" class="text-gray-500 hover:text-blue-600">Ana Sayfa</a>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                    <span id="breadcrumbCategory" class="text-gray-500 hover:text-blue-600 cursor-pointer">Turlar</span>
                    <i class="fas fa-chevron-right text-gray-400"></i>
                    <span id="breadcrumbTitle" class="text-gray-800 font-medium">Tur Detayı</span>
                </nav>
            </div>
        </div>

        <!-- Tour Hero Section -->
        <section class="hero-gradient text-white py-12">
            <div class="container mx-auto px-4">
                <div class="grid lg:grid-cols-3 gap-8">
                    <!-- Tour Image & Gallery -->
                    <div class="lg:col-span-2">
                        <div class="relative">
                            <div id="tourImageContainer" class="h-96 rounded-xl overflow-hidden shadow-2xl">
                                <div class="gradient-overlay absolute inset-0"></div>
                                <div class="absolute top-4 left-4 flex flex-wrap gap-2">
                                    <span id="tourBadge" class="px-3 py-1 bg-white/20 backdrop-blur rounded-full text-sm font-semibold">
                                        Kategori
                                    </span>
                                    <span id="featuredBadge" class="px-3 py-1 bg-yellow-500 text-white rounded-full text-sm font-semibold hidden">
                                        <i class="fas fa-star mr-1"></i>Öne Çıkan
                                    </span>
                                </div>
                                <div class="absolute bottom-4 right-4">
                                    <button class="bg-white/20 backdrop-blur text-white px-4 py-2 rounded-lg hover:bg-white/30 transition-colors">
                                        <i class="fas fa-images mr-2"></i>Galeri
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tour Info Summary -->
                    <div class="lg:col-span-1">
                        <div class="bg-white/10 backdrop-blur rounded-xl p-6 h-fit">
                            <h1 id="tourTitle" class="text-2xl font-bold mb-4">Tur Başlığı</h1>
                            
                            <div class="space-y-4">
                                <div class="flex items-center">
                                    <i class="fas fa-calendar-alt w-5 mr-3"></i>
                                    <span id="tourDates">Tarih bilgisi yükleniyor...</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-clock w-5 mr-3"></i>
                                    <span id="tourDuration">Süre bilgisi yükleniyor...</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-users w-5 mr-3"></i>
                                    <span id="tourQuota">Kota bilgisi yükleniyor...</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt w-5 mr-3"></i>
                                    <span>Mekke • Medine</span>
                                </div>
                            </div>

                            <div class="mt-6 pt-6 border-t border-white/20">
                                <div class="text-3xl font-bold mb-2" id="tourPrice">
                                    Fiyat yükleniyor...
                                </div>
                                <p class="text-sm opacity-75">Kişi başı, vergiler dahil</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Main Content -->
        <section class="py-12">
            <div class="container mx-auto px-4">
                <div class="grid lg:grid-cols-4 gap-8">
                    <!-- Left Content -->
                    <div class="lg:col-span-3">
                        <!-- Tab Navigation -->
                        <div class="bg-white rounded-xl shadow-sm overflow-hidden mb-8">
                            <div class="border-b">
                                <nav class="flex overflow-x-auto">
                                    <button onclick="showTab('overview')" class="tab-button flex-shrink-0 px-6 py-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors active">
                                        <i class="fas fa-info-circle mr-2"></i>Genel Bilgi
                                    </button>
                                    <button onclick="showTab('program')" class="tab-button flex-shrink-0 px-6 py-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                                        <i class="fas fa-calendar-day mr-2"></i>Program
                                    </button>
                                    <button onclick="showTab('hotels')" class="tab-button flex-shrink-0 px-6 py-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                                        <i class="fas fa-hotel mr-2"></i>Konaklama
                                    </button>
                                    <button onclick="showTab('services')" class="tab-button flex-shrink-0 px-6 py-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                                        <i class="fas fa-concierge-bell mr-2"></i>Hizmetler
                                    </button>
                                    <button onclick="showTab('documents')" class="tab-button flex-shrink-0 px-6 py-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300 transition-colors">
                                        <i class="fas fa-file-alt mr-2"></i>Belgeler
                                    </button>
                                </nav>
                            </div>

                            <!-- Tab Contents -->
                            <div class="p-6">
                                <!-- Overview Tab -->
                                <div id="tab-overview" class="tab-content active">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Tur Açıklaması</h3>
                                    <div id="tourDescription" class="prose max-w-none mb-8">
                                        <p class="text-gray-600 leading-relaxed">Tur açıklaması yükleniyor...</p>
                                    </div>

                                    <!-- Visit Places -->
                                    <div id="visitPlacesSection" class="mb-8">
                                        <h4 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                                            <i class="fas fa-mosque text-blue-500 mr-2"></i>
                                            Ziyaret Edilecek Yerler
                                        </h4>
                                        <div id="visitPlacesList" class="feature-grid">
                                            <!-- JavaScript ile doldurulacak -->
                                        </div>
                                    </div>

                                    <!-- Features -->
                                    <div class="grid md:grid-cols-3 gap-6">
                                        <div class="text-center p-6 bg-blue-50 rounded-xl">
                                            <i class="fas fa-user-tie text-blue-500 text-3xl mb-4"></i>
                                            <h5 class="font-semibold text-gray-800 mb-2">Deneyimli Rehber</h5>
                                            <p class="text-gray-600 text-sm">20 yıllık tecrübeli rehberlerimiz</p>
                                        </div>
                                        <div class="text-center p-6 bg-green-50 rounded-xl">
                                            <i class="fas fa-shield-alt text-green-500 text-3xl mb-4"></i>
                                            <h5 class="font-semibold text-gray-800 mb-2">Güvenli Yolculuk</h5>
                                            <p class="text-gray-600 text-sm">Tam sigortalı ve güvenli transfer</p>
                                        </div>
                                        <div class="text-center p-6 bg-purple-50 rounded-xl">
                                            <i class="fas fa-clock text-purple-500 text-3xl mb-4"></i>
                                            <h5 class="font-semibold text-gray-800 mb-2">7/24 Destek</h5>
                                            <p class="text-gray-600 text-sm">Yolculuk boyunca kesintisiz destek</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Program Tab -->
                                <div id="tab-program" class="tab-content">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                        <i class="fas fa-calendar-day text-blue-500 mr-3"></i>
                                        Günlük Program
                                    </h3>
                                    <div id="programDetails" class="space-y-6">
                                        <!-- JavaScript ile doldurulacak -->
                                    </div>
                                </div>

                                <!-- Hotels Tab -->
                                <div id="tab-hotels" class="tab-content">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                        <i class="fas fa-hotel text-blue-500 mr-3"></i>
                                        Konaklama Bilgileri
                                    </h3>
                                    <div id="hotelDetails" class="space-y-8">
                                        <!-- JavaScript ile doldurulacak -->
                                    </div>
                                </div>

                                <!-- Services Tab -->
                                <div id="tab-services" class="tab-content">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                        <i class="fas fa-concierge-bell text-blue-500 mr-3"></i>
                                        Hizmet Detayları
                                    </h3>
                                    
                                    <div class="grid md:grid-cols-2 gap-8">
                                        <!-- Included Services -->
                                        <div>
                                            <h4 class="text-lg font-semibold text-green-700 mb-4 flex items-center">
                                                <i class="fas fa-check-circle mr-2"></i>
                                                Dahil Hizmetler
                                            </h4>
                                            <div id="includedServicesList" class="space-y-2">
                                                <!-- JavaScript ile doldurulacak -->
                                            </div>
                                        </div>

                                        <!-- Excluded Services -->
                                        <div>
                                            <h4 class="text-lg font-semibold text-red-700 mb-4 flex items-center">
                                                <i class="fas fa-times-circle mr-2"></i>
                                                Dahil Olmayan Hizmetler
                                            </h4>
                                            <div id="excludedServicesList" class="space-y-2">
                                                <!-- JavaScript ile doldurulacak -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Documents Tab -->
                                <div id="tab-documents" class="tab-content">
                                    <h3 class="text-2xl font-bold text-gray-800 mb-6 flex items-center">
                                        <i class="fas fa-file-alt text-blue-500 mr-3"></i>
                                        Gerekli Belgeler
                                    </h3>
                                    <div id="documentsDetails" class="space-y-4">
                                        <!-- JavaScript ile doldurulacak -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Right Sidebar - Booking Card -->
                    <div class="lg:col-span-1">
                        <div class="sticky-booking">
                            <div class="pricing-card rounded-xl p-6 shadow-lg">
                                <div class="text-center mb-6">
                                    <div class="text-3xl font-bold text-gray-800 mb-2" id="sidebarPrice">
                                        Fiyat yükleniyor...
                                    </div>
                                    <p class="text-gray-600">Kişi başı, vergiler dahil</p>
                                </div>

                                <div class="space-y-4 mb-6">
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-gray-600">Başlangıç Tarihi:</span>
                                        <span class="font-medium" id="sidebarStartDate">-</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-gray-600">Süre:</span>
                                        <span class="font-medium" id="sidebarDuration">-</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-gray-200">
                                        <span class="text-gray-600">Kalan Kota:</span>
                                        <span class="font-medium" id="sidebarQuota">-</span>
                                    </div>
                                </div>

                                <div class="space-y-3">
                                    <button id="reserveButton" class="w-full bg-green-500 text-white py-3 rounded-lg font-semibold hover:bg-green-600 transition-colors">
                                        <i class="fas fa-phone mr-2"></i>Hemen Rezerve Et
                                    </button>
                                    <button id="whatsappButton" class="w-full bg-green-400 text-white py-3 rounded-lg font-semibold hover:bg-green-500 transition-colors">
                                        <i class="fab fa-whatsapp mr-2"></i>WhatsApp ile İletişim
                                    </button>
                                    <button id="infoButton" class="w-full bg-blue-500 text-white py-3 rounded-lg font-semibold hover:bg-blue-600 transition-colors">
                                        <i class="fas fa-info-circle mr-2"></i>Bilgi Al
                                    </button>
                                </div>

                                <div class="mt-6 pt-6 border-t border-gray-200">
                                    <div class="text-center text-sm text-gray-600">
                                        <i class="fas fa-shield-alt text-green-500 mr-2"></i>
                                        <span>%100 Güvenli Rezervasyon</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Floating Contact Button -->
    <div class="floating-contact">
        <button id="floatingWhatsapp" class="bg-green-500 text-white p-4 rounded-full shadow-lg hover:bg-green-600 transition-all hover:scale-110">
            <i class="fab fa-whatsapp text-2xl"></i>
        </button>
    </div>

    <!-- JavaScript -->
    <script>
        // Tab Management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(`tab-${tabName}`).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Tour Detail Manager
        class TourDetailManager {
            constructor() {
                this.tourId = this.getTourIdFromUrl();
                this.tour = null;
            }

            getTourIdFromUrl() {
                const pathParts = window.location.pathname.split('/');
                return pathParts[pathParts.length - 1];
            }

            async init() {
                if (!this.tourId) {
                    this.showError();
                    return;
                }

                await this.loadTourDetail();
            }

            async loadTourDetail() {
                try {
                    console.log('🔍 Tur detayları yükleniyor, ID:', this.tourId);
                    
                    const response = await fetch(`/api/tours/${this.tourId}`);
                    
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.success && data.data.tour) {
                        this.tour = data.data.tour;
                        console.log('✅ Tur detayı yüklendi:', this.tour);
                        this.renderTourDetail();
                    } else {
                        throw new Error('Tur bulunamadı');
                    }
                } catch (error) {
                    console.error('❌ Tur detay yükleme hatası:', error);
                    this.showError();
                }
            }

            renderTourDetail() {
                // Loading state'i gizle, content'i göster
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('tourContent').classList.remove('hidden');

                // Sayfa başlığını güncelle
                document.title = `${this.tour.title} - Nahletur.com`;

                // Render components
                this.renderBreadcrumb();
                this.renderHeroSection();
                this.renderTabContents();
                this.renderSidebarBooking();
                this.setupEventListeners();
            }

            renderBreadcrumb() {
                const categoryEl = document.getElementById('breadcrumbCategory');
                const titleEl = document.getElementById('breadcrumbTitle');

                if (this.tour.Category) {
                    categoryEl.textContent = this.tour.Category.name;
                    categoryEl.onclick = () => {
                        window.location.href = `/${this.tour.Category.slug}`;
                    };
                }

                titleEl.textContent = this.tour.title;
            }

            renderHeroSection() {
                // Tour image
                const imageContainer = document.getElementById('tourImageContainer');
                if (this.tour.image_url) {
                    imageContainer.style.backgroundImage = `url(${this.tour.image_url})`;
                    imageContainer.style.backgroundSize = 'cover';
                    imageContainer.style.backgroundPosition = 'center';
                }

                // Badge
                const badge = document.getElementById('tourBadge');
                if (this.tour.Category) {
                    badge.textContent = this.tour.Category.name;
                }

                // Featured badge
                if (this.tour.featured) {
                    document.getElementById('featuredBadge').classList.remove('hidden');
                }

                // Tour title
                document.getElementById('tourTitle').textContent = this.tour.title;

                // Tour dates
                const startDate = this.tour.start_date ? new Date(this.tour.start_date).toLocaleDateString('tr-TR') : 'Belirtilmemiş';
                const endDate = this.tour.end_date ? new Date(this.tour.end_date).toLocaleDateString('tr-TR') : '';
                document.getElementById('tourDates').textContent = endDate ? `${startDate} - ${endDate}` : startDate;

                // Tour duration
                let durationText = '';
                if (this.tour.duration_days) {
                    durationText = `${this.tour.duration_days} Gün`;
                    if (this.tour.duration_nights) {
                        durationText += ` ${this.tour.duration_nights} Gece`;
                    }
                }
                document.getElementById('tourDuration').textContent = durationText || 'Belirtilmemiş';

                // Tour quota
                const quota = this.tour.quota || 0;
                document.getElementById('tourQuota').textContent = quota > 0 ? `${quota} kişi kaldı` : 'Dolu';

                // Tour price
                document.getElementById('tourPrice').textContent = this.tour.formatted_price || '₺0';
            }

            renderTabContents() {
                // Overview tab
                this.renderOverviewTab();
                
                // Program tab
                this.renderProgramTab();
                
                // Hotels tab
                this.renderHotelsTab();
                
                // Services tab
                this.renderServicesTab();
                
                // Documents tab
                this.renderDocumentsTab();
            }

            renderOverviewTab() {
                // Description
                const descriptionEl = document.getElementById('tourDescription');
                descriptionEl.innerHTML = this.tour.description || this.tour.short_description || 'Detaylı açıklama bulunmuyor.';

                // Visit places
                this.renderVisitPlaces();
            }

            renderVisitPlaces() {
                const container = document.getElementById('visitPlacesList');
                
                if (this.tour.visit_places) {
                    const places = this.tour.visit_places.split('\n')
                        .map(place => place.trim().replace(/^[•\-\*]\s*/, ''))
                        .filter(place => place.length > 0);

                    if (places.length > 0) {
                        container.innerHTML = places.map(place => `
                            <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt text-blue-500 mr-3"></i>
                                    <span class="font-medium text-gray-800">${place}</span>
                                </div>
                            </div>
                        `).join('');
                    } else {
                        container.innerHTML = '<p class="text-gray-500">Ziyaret yerleri belirtilmemiş.</p>';
                    }
                } else {
                    container.innerHTML = '<p class="text-gray-500">Ziyaret yerleri belirtilmemiş.</p>';
                }
            }

            renderProgramTab() {
                const container = document.getElementById('programDetails');
                
                if (this.tour.daily_schedule) {
                    try {
                        const schedule = JSON.parse(this.tour.daily_schedule);
                        container.innerHTML = schedule.map((day, index) => `
                            <div class="timeline-item relative pl-16 pb-8">
                                <div class="day-number absolute left-0 top-0">
                                    ${index + 1}
                                </div>
                                <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                    <h4 class="text-lg font-semibold text-gray-800 mb-3">${day.title || `${index + 1}. Gün`}</h4>
                                    <p class="text-gray-600 mb-4">${day.description || ''}</p>
                                    ${day.activities ? `
                                        <div class="space-y-2">
                                            ${day.activities.map(activity => `
                                                <div class="flex items-center text-sm text-gray-600">
                                                    <i class="fas fa-clock text-blue-500 mr-2 w-4"></i>
                                                    <span class="font-medium mr-2">${activity.time || ''}:</span>
                                                    <span>${activity.activity || ''}</span>
                                                </div>
                                            `).join('')}
                                        </div>
                                    ` : ''}
                                </div>
                            </div>
                        `).join('');
                    } catch (e) {
                        container.innerHTML = `
                            <div class="bg-white rounded-lg p-6 shadow-sm border border-gray-100">
                                <p class="text-gray-600">${this.tour.daily_schedule}</p>
                            </div>
                        `;
                    }
                } else {
                    container.innerHTML = `
                        <div class="bg-gray-50 rounded-lg p-8 text-center">
                            <i class="fas fa-calendar-day text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-600">Detaylı günlük program yakında eklenecek.</p>
                        </div>
                    `;
                }
            }

            renderHotelsTab() {
                const container = document.getElementById('hotelDetails');
                
                let hotelContent = '';

                // Mekke Hotel
                if (this.tour.mekke_hotel) {
                    hotelContent += this.renderHotelCard('Mekke Oteli', this.tour.mekke_hotel, this.tour.mekke_nights);
                }

                // Medine Hotel
                if (this.tour.medine_hotel) {
                    hotelContent += this.renderHotelCard('Medine Oteli', this.tour.medine_hotel, this.tour.medine_nights);
                }

                if (hotelContent) {
                    container.innerHTML = hotelContent;
                } else {
                    container.innerHTML = `
                        <div class="bg-gray-50 rounded-lg p-8 text-center">
                            <i class="fas fa-hotel text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-600">Otel bilgileri yakında eklenecek.</p>
                        </div>
                    `;
                }
            }

            renderHotelCard(title, hotelInfo, nights) {
                const nightsText = nights ? `${nights} Gece` : '';
                
                return `
                    <div class="hotel-card bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
                        <div class="bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4">
                            <h4 class="text-xl font-semibold">${title}</h4>
                            ${nightsText ? `<p class="text-blue-100">${nightsText} konaklama</p>` : ''}
                        </div>
                        <div class="p-6">
                            <div class="prose max-w-none text-gray-600">
                                ${hotelInfo}
                            </div>
                        </div>
                    </div>
                `;
            }

            renderServicesTab() {
                this.renderIncludedServices();
                this.renderExcludedServices();
            }

            renderIncludedServices() {
                const container = document.getElementById('includedServicesList');
                
                if (this.tour.included_services) {
                    const services = this.tour.included_services.split('\n')
                        .map(service => service.trim().replace(/^[•\-\*]\s*/, ''))
                        .filter(service => service.length > 0);

                    container.innerHTML = services.map(service => `
                        <div class="flex items-start">
                            <i class="fas fa-check text-green-500 mr-3 mt-1 flex-shrink-0"></i>
                            <span class="text-gray-700">${service}</span>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500">Dahil hizmetler belirtilmemiş.</p>';
                }
            }

            renderExcludedServices() {
                const container = document.getElementById('excludedServicesList');
                
                if (this.tour.excluded_services) {
                    const services = this.tour.excluded_services.split('\n')
                        .map(service => service.trim().replace(/^[•\-\*]\s*/, ''))
                        .filter(service => service.length > 0);

                    container.innerHTML = services.map(service => `
                        <div class="flex items-start">
                            <i class="fas fa-times text-red-500 mr-3 mt-1 flex-shrink-0"></i>
                            <span class="text-gray-700">${service}</span>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p class="text-gray-500">Dahil olmayan hizmetler belirtilmemiş.</p>';
                }
            }

            renderDocumentsTab() {
                const container = document.getElementById('documentsDetails');
                
                if (this.tour.required_documents) {
                    const documents = this.tour.required_documents.split('\n')
                        .map(doc => doc.trim().replace(/^[•\-\*]\s*/, ''))
                        .filter(doc => doc.length > 0);

                    container.innerHTML = documents.map(doc => `
                        <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                            <div class="flex items-center">
                                <i class="fas fa-file-alt text-blue-500 mr-3"></i>
                                <span class="text-gray-700">${doc}</span>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = `
                        <div class="bg-gray-50 rounded-lg p-8 text-center">
                            <i class="fas fa-file-alt text-gray-400 text-4xl mb-4"></i>
                            <p class="text-gray-600">Gerekli belgeler yakında eklenecek.</p>
                        </div>
                    `;
                }
            }

            renderSidebarBooking() {
                // Price
                document.getElementById('sidebarPrice').textContent = this.tour.formatted_price || '₺0';

                // Start date
                const startDate = this.tour.start_date ? new Date(this.tour.start_date).toLocaleDateString('tr-TR') : '-';
                document.getElementById('sidebarStartDate').textContent = startDate;

                // Duration
                let durationText = '';
                if (this.tour.duration_days) {
                    durationText = `${this.tour.duration_days} Gün`;
                    if (this.tour.duration_nights) {
                        durationText += ` ${this.tour.duration_nights} Gece`;
                    }
                }
                document.getElementById('sidebarDuration').textContent = durationText || '-';

                // Quota
                const quota = this.tour.quota || 0;
                document.getElementById('sidebarQuota').textContent = quota > 0 ? `${quota} kişi` : 'Dolu';
            }

            setupEventListeners() {
                // Reserve button
                document.getElementById('reserveButton').addEventListener('click', () => {
                    this.handleReservation();
                });

                // WhatsApp buttons
                document.getElementById('whatsappButton').addEventListener('click', () => {
                    this.openWhatsApp();
                });

                document.getElementById('floatingWhatsapp').addEventListener('click', () => {
                    this.openWhatsApp();
                });

                // Info button
                document.getElementById('infoButton').addEventListener('click', () => {
                    this.requestInfo();
                });

                // Share button
                document.getElementById('shareButton').addEventListener('click', () => {
                    this.shareTour();
                });

                // Favorite button
                document.getElementById('favoriteButton').addEventListener('click', () => {
                    this.toggleFavorite();
                });
            }

            handleReservation() {
                const phoneNumber = '905551234567'; // Gerçek telefon numaranız
                window.open(`tel:${phoneNumber}`, '_self');
            }

            openWhatsApp() {
                const phoneNumber = '905551234567'; // Gerçek WhatsApp numaranız
                const message = `Merhaba, "${this.tour.title}" turuna rezervasyon yapmak istiyorum. Detaylı bilgi alabilir miyim?`;
                const whatsappUrl = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            }

            requestInfo() {
                // İletişim sayfasına yönlendir veya modal aç
                window.location.href = '/iletisim';
            }

            shareTour() {
                if (navigator.share) {
                    navigator.share({
                        title: this.tour.title,
                        text: this.tour.short_description || this.tour.description,
                        url: window.location.href
                    });
                } else {
                    // Fallback: Copy to clipboard
                    navigator.clipboard.writeText(window.location.href).then(() => {
                        alert('Tur linki kopyalandı!');
                    });
                }
            }

            toggleFavorite() {
                const button = document.getElementById('favoriteButton');
                const icon = button.querySelector('i');
                
                if (icon.classList.contains('far')) {
                    icon.classList.remove('far');
                    icon.classList.add('fas');
                    icon.style.color = '#ef4444';
                } else {
                    icon.classList.remove('fas');
                    icon.classList.add('far');
                    icon.style.color = '';
                }
            }

            showError() {
                document.getElementById('loadingState').classList.add('hidden');
                document.getElementById('errorState').classList.remove('hidden');
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            const tourDetail = new TourDetailManager();
            tourDetail.init();
        });
    </script>
</body>
</html>